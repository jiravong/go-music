# Go Music API

RESTful API for Music Management using Go, Clean Architecture, Gin, GORM, and PostgreSQL.

## Features

- **Music CRUD**: Manage music tracks (Title, Artist, Lyrics, MP3, MP4).
- **Authentication**: JWT based authentication (Register, Login).
- **File Upload**: Support for uploading MP3 and MP4 files (Local Storage or AWS S3).
- **API Documentation**: Interactive API documentation via Swagger/OpenAPI (Huma).
- **Clean Architecture**: Separation of concerns (Domain, Service, Repository, Delivery).

## Tech Stack

- **Language**: Go
- **Framework**: Gin
- **API Documentation**: Huma
- **Database**: PostgreSQL
- **ORM**: GORM
- **Authentication**: JWT (golang-jwt)
- **File Storage**: Local filesystem / AWS S3

## Setup

1. **Prerequisites**:
   - Go 1.21+
   - PostgreSQL

2. **Clone the repository**:
   ```sh
   git clone <repo-url>
   cd go-music-api
   ```

3. **Environment Setup**:
   Copy the example environment file or create a `.env` file:
   ```sh
   DB_HOST=localhost
   DB_USER=postgres
   DB_PASSWORD=postgres
   DB_NAME=music_db
   DB_PORT=5432
   PORT=8080
   JWT_SECRET=your-secret-key
   
   # Storage Configuration (local or s3)
   STORAGE_TYPE=local
   
   # Local Storage Config
   UPLOAD_DIR=./uploads
   BASE_URL=http://localhost:8080/uploads

   # S3 Storage Config (Required if STORAGE_TYPE=s3)
   # AWS_ACCESS_KEY_ID=your-access-key
   # AWS_SECRET_ACCESS_KEY=your-secret-key
   # AWS_REGION=us-east-1
   # AWS_BUCKET_NAME=your-bucket-name
   ```

4. **Install Dependencies**:
   ```sh
   go mod tidy
   ```

5. **Run the Application**:
   ```sh
   go run cmd/api/main.go
   ```

## API Documentation

The API provides interactive documentation generated by Huma.

- **Interactive Docs**: [http://localhost:8080/docs](http://localhost:8080/docs)
- **OpenAPI Spec**: [http://localhost:8080/openapi.json](http://localhost:8080/openapi.json)

## API Endpoints

### Auth
- `POST /api/v1/auth/register` - Register a new user
- `POST /api/v1/auth/login` - Login and get JWT
- `POST /api/v1/auth/refresh-token` - Refresh Access Token

### Music (Requires Bearer Token)
- `POST /api/v1/music/` - Create a new music (Multipart form data: title, artist, lyrics, mp3_file, mp4_file)
- `GET /api/v1/music/` - Get all music
- `GET /api/v1/music/:id` - Get music by ID
- `PUT /api/v1/music/:id` - Update music details
- `DELETE /api/v1/music/:id` - Delete music

## Folder Structure

```
.
├── cmd
│   └── api
│       └── main.go           # Entry point
├── internal
│   ├── delivery
│   │   ├── http              # HTTP Handlers and Middleware
│   │   └── middleware        # Auth and CORS Middleware
│   ├── domain                # Business entities and Interfaces
│   ├── infrastructure        # External frameworks (DB, Storage)
│   ├── repository            # Data access implementation
│   └── service               # Business logic
└── pkg
    └── utils                 # Shared utilities
```
